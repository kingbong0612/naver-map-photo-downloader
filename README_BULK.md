# 네이버 맵 대량 사진 다운로더 (엑셀 기반)

엑셀 리스트를 기반으로 여러 매장의 네이버 지도 사진을 자동으로 다운로드하는 Python 스크립트입니다.

## ✨ 주요 기능

- ✅ **엑셀 파일 기반 대량 처리**: 여러 매장을 한 번에 처리
- ✅ **체계적인 폴더 구조**: `지역/지역상세/매장명` 3단계 폴더 생성
- ✅ **카테고리별 분류**: 업체사진, 외부, 내부 등 카테고리별 하위 폴더 생성
- ✅ **네이버 지도 링크 저장**: 각 매장 폴더에 HTML 링크 파일 저장 (크로스체크용)
- ✅ **원본 고화질 이미지**: 썸네일이 아닌 원본 크기 다운로드
- ✅ **진행률 표시**: 실시간 처리 현황 확인
- ✅ **통계 리포트**: 최종 다운로드 통계 제공

## 📁 생성되는 폴더 구조

```
downloads/
├── 서울/
│   ├── 중구/
│   │   ├── 온아2호/
│   │   │   ├── 네이버지도_링크.html  ← 크로스체크용 링크 파일
│   │   │   ├── 업체사진/
│   │   │   │   ├── 업체사진_001.jpg
│   │   │   │   ├── 업체사진_002.jpg
│   │   │   │   └── ...
│   │   │   ├── 외부/
│   │   │   │   ├── 외부_001.jpg
│   │   │   │   └── ...
│   │   │   └── 내부/
│   │   │       ├── 내부_001.jpg
│   │   │       └── ...
│   │   ├── 라힌/
│   │   │   └── ...
│   │   └── ...
│   └── 강남구/
│       └── ...
└── 경기/
    └── ...
```

## 📊 엑셀 파일 형식

엑셀 파일은 다음과 같은 컬럼을 포함해야 합니다:

| 지역 | 지역상세 | 매장명 | 네이버지도링크 |
|------|---------|--------|---------------|
| 서울 | 중구 | 온아2호 | https://naver.me/FfB3j16z |
| 서울 | 중구 | 라힌 | https://naver.me/xt4x64Wj |
| 경기 | 성남시 | 카페ABC | https://naver.me/xxxxx |

**필수 컬럼:**
- `지역`: 대분류 지역 (예: 서울, 경기, 부산)
- `지역상세`: 소분류 지역 (예: 중구, 강남구, 분당구)
- `매장명`: 매장/업체 이름
- `네이버지도링크`: 네이버 지도 URL (naver.me 또는 map.naver.com)

## 🚀 설치 및 사용 방법

### 1. 필수 패키지 설치

```bash
pip install -r requirements.txt
```

### 2. Chrome 브라우저 설치

#### Ubuntu/Debian:
```bash
wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
sudo dpkg -i google-chrome-stable_current_amd64.deb
sudo apt-get install -f
```

#### macOS:
```bash
brew install --cask google-chrome
```

#### Windows:
- Chrome 다운로드: https://www.google.com/chrome/

### 3. 스크립트 실행

```bash
python naver_map_bulk_downloader.py 리스트_네이버지도링크추가.xlsx
```

## 📋 실행 화면 예시

```
============================================================
🚀 네이버 맵 대량 사진 다운로더 시작
============================================================

📊 엑셀 파일 로드: 45개 행 발견
컬럼: ['지역', '지역상세', '매장명', 'Unnamed: 3', '네이버지도링크']

✅ Chrome 드라이버 초기화 완료

============================================================
[1/45] 처리 중: 서울 > 중구 > 온아2호
============================================================
   📁 폴더 생성: downloads/서울/중구/온아2호
   🔗 링크 파일 저장: 네이버지도_링크.html
   🌐 페이지 로딩: https://naver.me/FfB3j16z
   📷 사진 탭 클릭 완료
   📂 발견된 카테고리: 업체사진, 외부, 내부
   ✅ 총 24개 사진 URL 추출 완료
   📁 카테고리: 업체사진 (12개)
   📁 카테고리: 외부 (8개)
   📁 카테고리: 내부 (4개)
   ✅ 24개 사진 다운로드 완료

📊 진행률: 2.2% (1/45)
```

## 🔍 크로스체크 방법

각 매장 폴더에 저장된 `네이버지도_링크.html` 파일을 열면:
1. 매장 이름 표시
2. 네이버 지도 링크 표시
3. "네이버 지도에서 보기" 버튼으로 바로 이동 가능
4. 다운로드 날짜/시간 기록

## 📊 최종 통계 예시

```
============================================================
📊 최종 통계
============================================================
총 처리 대상: 45개
✅ 성공: 42개
❌ 실패: 2개
⚠️  링크 없음: 1개
📷 다운로드한 총 사진 수: 586개
⏱️  소요 시간: 18.5분
📁 저장 위치: /home/user/downloads
============================================================
```

## ⚙️ 주요 기능 설명

### 1. 자동 카테고리 감지
- 네이버 지도의 사진 카테고리를 자동으로 감지
- 업체사진, 외부, 내부, 메뉴 등 다양한 카테고리 지원
- 카테고리가 없으면 "전체사진" 폴더에 저장

### 2. 고화질 이미지 다운로드
- 썸네일 URL을 원본 크기로 자동 변환
- `?type=w120` → `?type=w1200`
- JPG, PNG, WebP 등 다양한 포맷 지원

### 3. 안정성 기능
- 5개 매장 처리마다 3초 대기 (과부하 방지)
- 실패한 매장은 건너뛰고 계속 진행
- Ctrl+C로 중단 가능 (이미 다운로드한 파일은 유지)

### 4. 진행률 추적
- 실시간 진행률 표시
- 각 매장별 처리 상태 출력
- 최종 통계 리포트 제공

## ⚠️ 주의사항

1. **저작권**: 다운로드한 사진은 개인적인 용도로만 사용하세요
2. **처리 시간**: 매장 수와 사진 개수에 따라 시간이 오래 걸릴 수 있습니다
   - 예: 45개 매장, 약 15~30분 소요
3. **네트워크**: 안정적인 인터넷 연결 필요
4. **디스크 공간**: 충분한 저장 공간 확보 필요

## 🐛 문제 해결

### Chrome 드라이버 오류
- Selenium 4.6+ 버전은 자동으로 드라이버를 관리합니다
- Chrome 브라우저가 설치되어 있는지 확인하세요

### 사진을 찾을 수 없는 경우
- 해당 매장에 사진이 등록되지 않았을 수 있습니다
- 비공개 설정된 사진은 다운로드할 수 없습니다

### 메모리 부족
- 한 번에 처리하는 매장 수를 줄이세요
- 엑셀 파일을 분할하여 여러 번 실행하세요

## 📝 추가 기능 요청

더 필요한 기능이 있으면 말씀해주세요:
- [ ] 특정 카테고리만 다운로드
- [ ] 이미지 크기 제한
- [ ] 중복 이미지 제거
- [ ] 실패한 매장만 재시도

## 📄 라이선스

개인적인 용도로 자유롭게 사용하세요.
