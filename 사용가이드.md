# 🗺️ 네이버 맵 사진 다운로더 - 완전 가이드

엑셀 리스트의 네이버 지도 링크에서 모든 사진을 자동으로 다운로드하는 스크립트입니다.

---

## 📋 목차

1. [빠른 시작](#빠른-시작)
2. [상세 기능](#상세-기능)
3. [사용 방법](#사용-방법)
4. [폴더 구조](#폴더-구조)
5. [문제 해결](#문제-해결)

---

## 🚀 빠른 시작

### 1단계: 패키지 설치
```bash
pip install -r requirements.txt
```

### 2단계: Chrome 설치 (없는 경우)
```bash
# Ubuntu/Debian
sudo apt-get install chromium-browser

# macOS
brew install --cask google-chrome
```

### 3단계: 실행
```bash
# 방법 1: 자동 실행 스크립트 (권장)
./run_bulk_downloader.sh

# 방법 2: 직접 실행
python naver_map_bulk_downloader.py 리스트_네이버지도링크추가.xlsx
```

---

## ✨ 상세 기능

### 1️⃣ 엑셀 기반 대량 처리
- 한 번에 수십~수백 개 매장 처리 가능
- 자동으로 지역/지역상세/매장명 폴더 생성
- 진행률 실시간 표시

### 2️⃣ 카테고리별 사진 분류
네이버 지도의 사진 카테고리를 자동 감지하여 분류:
- 📷 **업체사진**: 대표 이미지
- 🏢 **외부**: 건물 외관
- 🏠 **내부**: 실내 사진
- 🍽️ **메뉴**: 음식 사진
- 📝 **기타**: 추가 카테고리

카테고리가 없으면 **"전체사진"** 폴더에 저장됩니다.

### 3️⃣ 크로스체크 링크 파일
각 매장 폴더에 `네이버지도_링크.html` 파일 생성:
```
매장명/
├── 네이버지도_링크.html  ← 이 파일 클릭!
├── 업체사진/
├── 외부/
└── 내부/
```

**링크 파일 기능:**
- ✅ 매장 정보 표시
- ✅ 네이버 지도 바로가기 버튼
- ✅ 다운로드 날짜 기록
- ✅ 크로스체크 용이

### 4️⃣ 고화질 원본 다운로드
- 썸네일 → 원본 크기 자동 변환
- JPG, PNG, WebP 등 다양한 포맷 지원
- 최대 1200px 폭 이미지 다운로드

### 5️⃣ 안정성 & 에러 처리
- ⏸️ 5개 매장마다 3초 대기 (과부하 방지)
- ⏭️ 실패한 매장 건너뛰고 계속 진행
- 🛑 Ctrl+C 중단 가능 (이미 받은 파일 유지)
- 📊 최종 통계 리포트 제공

---

## 📖 사용 방법

### 엑셀 파일 준비

**필수 컬럼:**

| 컬럼명 | 설명 | 예시 |
|--------|------|------|
| 지역 | 대분류 지역 | 서울, 경기, 부산 |
| 지역상세 | 소분류 지역 | 중구, 강남구, 분당구 |
| 매장명 | 매장/업체 이름 | 온아2호, 스타벅스 등 |
| 네이버지도링크 | 네이버 지도 URL | https://naver.me/xxxxx |

**엑셀 예시:**
```
지역  | 지역상세 | 매장명        | 네이버지도링크
--------------------------------------------------
서울  | 중구     | 온아2호       | https://naver.me/FfB3j16z
서울  | 중구     | 라힌         | https://naver.me/xt4x64Wj
경기  | 성남시   | 카페ABC      | https://naver.me/xxxxx
```

### 실행 화면

```bash
$ python naver_map_bulk_downloader.py 리스트_네이버지도링크추가.xlsx

============================================================
🚀 네이버 맵 대량 사진 다운로더 시작
============================================================

📊 엑셀 파일 로드: 45개 행 발견
✅ Chrome 드라이버 초기화 완료

============================================================
[1/45] 처리 중: 서울 > 중구 > 온아2호
============================================================
   📁 폴더 생성: downloads/서울/중구/온아2호
   🔗 링크 파일 저장: 네이버지도_링크.html
   🌐 페이지 로딩: https://naver.me/FfB3j16z
   📷 사진 탭 클릭 완료
   📂 발견된 카테고리: 업체사진, 외부, 내부
   ✅ 총 24개 사진 URL 추출 완료
   📁 카테고리: 업체사진 (12개)
   📁 카테고리: 외부 (8개)
   📁 카테고리: 내부 (4개)
   ✅ 24개 사진 다운로드 완료

📊 진행률: 2.2% (1/45)

============================================================
[2/45] 처리 중: 서울 > 중구 > 라힌
============================================================
...
```

### 최종 통계

```
============================================================
📊 최종 통계
============================================================
총 처리 대상: 45개
✅ 성공: 42개
❌ 실패: 2개
⚠️  링크 없음: 1개
📷 다운로드한 총 사진 수: 586개
⏱️  소요 시간: 18.5분
📁 저장 위치: /home/user/downloads
============================================================
```

---

## 📁 폴더 구조

```
downloads/
│
├── 서울/
│   ├── 중구/
│   │   ├── 온아2호/
│   │   │   ├── 네이버지도_링크.html  ← 🔗 크로스체크용
│   │   │   ├── 업체사진/
│   │   │   │   ├── 업체사진_001.jpg
│   │   │   │   ├── 업체사진_002.jpg
│   │   │   │   └── 업체사진_003.jpg
│   │   │   ├── 외부/
│   │   │   │   ├── 외부_001.jpg
│   │   │   │   └── 외부_002.jpg
│   │   │   └── 내부/
│   │   │       ├── 내부_001.jpg
│   │   │       ├── 내부_002.jpg
│   │   │       └── 내부_003.jpg
│   │   │
│   │   ├── 라힌/
│   │   │   ├── 네이버지도_링크.html
│   │   │   └── 전체사진/  ← 카테고리가 없으면 여기에
│   │   │       ├── photo_001.jpg
│   │   │       └── photo_002.jpg
│   │   │
│   │   └── 수련/
│   │       └── ...
│   │
│   └── 강남구/
│       └── ...
│
├── 경기/
│   ├── 성남시/
│   │   └── ...
│   └── 수원시/
│       └── ...
│
└── 부산/
    └── ...
```

---

## 🔍 크로스체크 방법

### 1. 네이버지도_링크.html 파일 열기
각 매장 폴더의 `네이버지도_링크.html` 파일을 브라우저에서 엽니다.

### 2. 내용 확인
- 📍 매장명
- 🔗 네이버 지도 링크
- 🗓️ 다운로드 날짜/시간

### 3. 네이버 지도에서 직접 확인
"네이버 지도에서 보기" 버튼 클릭 → 실제 매장 페이지로 이동

### 4. 사진 비교
- 다운로드된 사진과 실제 네이버 지도 사진 비교
- 누락된 사진이 있는지 확인
- 카테고리 분류가 올바른지 확인

---

## 🐛 문제 해결

### ❌ Chrome 드라이버 오류

**증상:**
```
selenium.common.exceptions.WebDriverException: Message: 'chromedriver' executable needs to be in PATH
```

**해결:**
```bash
# Ubuntu/Debian
sudo apt-get install chromium-browser chromium-chromedriver

# macOS
brew install --cask google-chrome

# Windows
# Chrome 브라우저를 https://www.google.com/chrome/ 에서 다운로드
```

### ⚠️ 사진을 찾을 수 없는 경우

**원인:**
1. 매장에 등록된 사진이 없음
2. 비공개 설정된 사진
3. 네이버 지도 페이지 구조 변경

**확인 방법:**
1. `네이버지도_링크.html` 파일을 열어 직접 확인
2. 네이버 지도에서 사진 탭이 있는지 확인

### 💾 메모리 부족

**증상:**
- 프로그램이 느려지거나 멈춤
- 시스템이 전반적으로 느려짐

**해결:**
1. **엑셀 파일 분할**
   ```python
   # 첫 20개만 처리
   df_part1 = df.head(20)
   df_part1.to_excel('리스트_part1.xlsx', index=False)
   ```

2. **처리 대기 시간 증가**
   - 스크립트 내 `time.sleep(3)` → `time.sleep(5)` 변경

### 🌐 네트워크 오류

**증상:**
```
requests.exceptions.ConnectionError: Failed to establish a new connection
```

**해결:**
1. 인터넷 연결 확인
2. 방화벽 설정 확인
3. VPN 사용 시 해제 후 재시도

### 📝 엑셀 읽기 오류

**증상:**
```
ValueError: Excel file format cannot be determined
```

**해결:**
```bash
# openpyxl 재설치
pip install --upgrade openpyxl pandas
```

---

## ⚙️ 고급 설정

### 다운로드 폴더 변경

스크립트 실행 시:
```python
downloader = NaverMapBulkDownloader(excel_path, base_folder="custom_folder")
```

### 스크롤 횟수 조정

스크립트 내 `max_scrolls` 변경:
```python
# 더 많은 사진 로드
max_scrolls = 20  # 기본값: 15
```

### 이미지 크기 변경

`convert_to_original_size` 함수에서:
```python
# w1200 → w800으로 변경하여 파일 크기 줄이기
('?type=w120', '?type=w800'),
```

---

## 📊 성능 정보

### 처리 속도 (예상)
- **1개 매장**: 약 20~40초
- **10개 매장**: 약 5~8분
- **50개 매장**: 약 20~30분
- **100개 매장**: 약 40~60분

*사진 개수와 네트워크 속도에 따라 변동*

### 디스크 공간
- **매장당 평균**: 5~15MB
- **100개 매장**: 약 500MB~1.5GB

### 메모리 사용
- **최소**: 500MB
- **권장**: 2GB 이상

---

## ⚠️ 주의사항

1. **저작권**
   - 다운로드한 사진은 개인적인 용도로만 사용
   - 상업적 이용 금지
   - 원본 출처 표시 권장

2. **서버 부하**
   - 너무 빠른 요청은 IP 차단 원인
   - 스크립트에 내장된 대기 시간 유지
   - 한 번에 너무 많은 매장 처리 자제

3. **개인정보**
   - 민감한 정보가 포함된 사진 주의
   - 다운로드 폴더 공유 시 주의

---

## 📞 지원

문제가 발생하거나 추가 기능이 필요한 경우:
1. GitHub Issues 등록
2. 상세한 오류 메시지 포함
3. 엑셀 파일 구조 설명

---

## 📝 변경 이력

### v1.0.0 (2026-02-03)
- ✨ 초기 버전 출시
- ✅ 엑셀 기반 대량 처리
- ✅ 카테고리별 사진 분류
- ✅ 크로스체크용 링크 파일
- ✅ 고화질 원본 다운로드
- ✅ 진행률 및 통계 표시

---

**만든이**: AI Assistant  
**버전**: 1.0.0  
**날짜**: 2026-02-03  
**라이선스**: 개인 용도 자유 사용
